<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¶åº­é˜…è¯»å†’é™©å²›</title>
    <style>
        :root {
            --primary: #4a6fa5;
            --secondary: #ff9e4f;
            --light: #f0f7ff;
            --success: #6bbf59;
        }
                body {
            font-family: 'Comic Sans MS', 'Microsoft YaHei', sans-serif;
            background-color: var(--light);
            margin: 0;
            padding: 20px;
            color: #333;
        }
        header {
            background-color: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }
        h1 {
            margin: 10px 0;
                        font-size: 24px;
        }
        .family-container {
            display: flex;
            flex-wrap: nowrap;
            gap: 20px;
            justify-content: center;
            margin-bottom: 20px;
            overflow-x: auto;
        }
        .member-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            min-width: 150px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        .member-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--secondary);
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 30px; /* å¢å¤§Emojiå¤§å° */
        }
                .progress-container {
            margin: 10px 0;
        }
        .progress-bar {
            height: 15px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: var(--success);
            width: 0%;
            transition: width 0.5s ease;
        }
        .checkin-form {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            position: relative;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
                    }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
        }
        .checkin-options {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .checkin-option {
            flex: 1;
            text-align: center;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .checkin-option.selected {
            background: var(--secondary);
            color: white;
        }
        button {
            background-color: var(--primary);
            color: white;
            border: none;
                        padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            width: 100%;
        }
        button:hover {
            background-color: #3a5a8f;
        }
        .reset-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: #f44336;
            width: auto;
            padding: 8px 12px;
            font-size: 14px;
        }
        .reset-btn:hover {
                  background-color: #d32f2f;
        }
        .family-goal {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        .tree-container {
            margin: 20px 0;
        }
        .tree {
            font-size: 80px;
            display: inline-block;
            transition: all 0.5s;
            transform-origin: bottom;
        }
        .tree-small { transform: scale(0.6); opacity: 0.8; }
        .tree-medium { transform: scale(1); }
        .tree-large { transform: scale(1.3); }
        .hidden {
            display: none;
        }
        .member-points {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            margin: 5px 0;
        }
            </style>
</head>
<body>
    <header>
        <h1>å®¶åº­é˜…è¯»å†’é™©å²›</h1>
        <p>ä¸€èµ·é˜…è¯»ï¼Œä¸€èµ·æˆé•¿ï¼</p>
    </header>

    <div class="family-container" id="family-members">
        <!-- å®¶åº­æˆå‘˜å¡ç‰‡ä¼šåŠ¨æ€æ·»åŠ  -->
    </div>

    <div class="checkin-form">
        <h2>ä»Šæ—¥æ‰“å¡</h2>
        <button class="reset-btn" onclick="resetToday()">é‡ç½®å½“æ—¥è®°å½•</button>
        
        <div class="form-group">
            <label for="member-select">é€‰æ‹©å®¶åº­æˆå‘˜</label>
            <select id="member-select">
                <option value="">-- è¯·é€‰æ‹© --</option>
                <!-- æˆå‘˜é€‰é¡¹ä¼šåŠ¨æ€æ·»åŠ  -->
            </select>
        </div>
        
        <div class="checkin-options">
            <div class="checkin-option selected" data-type="reading" onclick="selectCheckinType(this, 'reading')">ğŸ“– é˜…è¯»æ‰“å¡</div>
            <div class="checkin-option" data-type="book" onclick="selectCheckinType(this, 'book')">ğŸ“š è¯»å®Œä¸€æœ¬ä¹¦</div>
        </div>
        
        <div id="reading-form" class="checkin-type-form">
                    <div class="form-group">
                <label for="book-title">ä¹¦å</label>
                <input type="text" id="book-title" placeholder="è¯·è¾“å…¥ä¹¦å">
            </div>
            <div class="form-group">
                <label for="reading-time">é˜…è¯»æ—¶é•¿ (åˆ†é’Ÿ)</label>
                <input type="number" id="reading-time" placeholder="è¯·è¾“å…¥åˆ†é’Ÿæ•°">
            </div>
        </div>
        
        <div id="book-form" class="checkin-type-form hidden">
            <div class="form-group">
                <label for="finished-book">ä¹¦å</label>
                <input type="text" id="finished-book" placeholder="è¯·è¾“å…¥ä¹¦å">
            </div>
            <div class="form-group">
                <label for="book-pages">æ€»é¡µæ•°</label>
                <input type="number" id="book-pages" placeholder="è¯·è¾“å…¥æ€»é¡µæ•°">
            </div>
        </div>
        
        <button onclick="submitCheckin()">æäº¤æ‰“å¡</button>
    </div>

    <div class="family-goal">
        <h2>å®¶åº­ç›®æ ‡</h2>
        <p>æœ¬å‘¨å…¨å®¶é˜…è¯»æ€»æ—¶é•¿ç›®æ ‡: <strong>7å°æ—¶</strong></p>
        <p>å·²å®Œæˆ: <span id="family-time">0</span>å°æ—¶</p>
        <div class="progress-container">
            <div class="progress-bar">
                            <div class="progress-fill" id="family-progress"></div>
            </div>
        </div>
        
        <div class="tree-container">
            <div class="tree tree-small" id="family-tree">ğŸŒ±</div>
        </div>
    </div>

    <script>
        // å®¶åº­æˆå‘˜æ•°æ®
        let familyMembers = [
            { id: 1, name: "çˆ¸çˆ¸", emoji: "ğŸ‘¨", color: "#4a6fa5", points: 0, time: 0, books: 0 },
            { id: 2, name: "å¦ˆå¦ˆ", emoji: "ğŸ‘©", color: "#c76fd6", points: 0, time: 0, books: 0 },
            { id: 3, name: "å­©å­", emoji: "ğŸ§’", color: "#6bbf59", points: 0, time: 0, books: 0 }
        ];
        
        // å½“æ—¥æ‰“å¡è®°å½•(ç”¨äºé‡ç½®åŠŸèƒ½)
        let todayCheckins = [];
        
        // å®¶åº­æ€»é˜…è¯»æ—¶é—´(åˆ†é’Ÿ)
        let familyTotalTime = 0;
        
        // å½“å‰é€‰ä¸­çš„æ‰“å¡ç±»å‹
        let currentCheckinType = 'reading';
        
        // åˆå§‹åŒ–é¡µé¢
        function initPage() {
            renderFamilyMembers();
            renderCheckinSelect();
                        updateFamilyProgress();
        }
        
        // æ¸²æŸ“å®¶åº­æˆå‘˜å¡ç‰‡
        function renderFamilyMembers() {
            const container = document.getElementById('family-members');
            container.innerHTML = '';
            
            familyMembers.forEach(member => {
                const card = document.createElement('div');
                card.className = 'member-card';
                card.innerHTML = `
                    <div class="member-avatar" style="background-color: ${member.color}">${member.emoji}</div>
                    <h3>${member.name}</h3>
                    <div class="member-points">${member.points}åˆ†</div>
                    <p>é˜…è¯»: ${Math.floor(member.time/60)}h${member.time%60}m</p>
                    <p>ä¹¦ç±: ${member.books}æœ¬</p>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%; background-color: ${member.color}"></div>
                         </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // æ¸²æŸ“æ‰“å¡é€‰æ‹©ä¸‹æ‹‰æ¡†
        function renderCheckinSelect() {
            const select = document.getElementById('member-select');
            select.innerHTML = '<option value="">-- è¯·é€‰æ‹© --</option>';
            
            familyMembers.forEach(member => {
                const option = document.createElement('option');
                option.value = member.id;
                option.textContent = `${member.emoji} ${member.name}`;
                select.appendChild(option);
            });
        }
        
        // é€‰æ‹©æ‰“å¡ç±»å‹
                function selectCheckinType(element, type) {
            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.checkin-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            
            // éšè—æ‰€æœ‰è¡¨å•
            document.querySelectorAll('.checkin-type-form').forEach(form => {
                form.classList.add('hidden');
                          });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„è¡¨å•
            document.getElementById(`${type}-form`).classList.remove('hidden');
            
            currentCheckinType = type;
        }
        
        // æäº¤æ‰“å¡
        function submitCheckin() {
            const memberId = parseInt(document.getElementById('member-select').value);
            if (!memberId) {
                alert('è¯·é€‰æ‹©å®¶åº­æˆå‘˜');
                return;
            }
            
            const member = familyMembers.find(m => m.id === memberId);
            if (!member) return;
            
            let points = 0;
            let time = 0;
            let books = 0;  
                        let description = '';
            
            switch (currentCheckinType) {
                case 'reading':
                    const readingTime = parseInt(document.getElementById('reading-time').value) || 0;
                    const bookTitle = document.getElementById('book-title').value.trim();
                    
                    if (!bookTitle) {
                        alert('è¯·è¾“å…¥ä¹¦å');
                        return;
                    }
                    
                    if (readingTime <= 0) {
                        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é˜…è¯»æ—¶é—´');
                        return;
                    }
                    
                    points = Math.floor(readingTime / 10);
                    time = readingTime;
                    description = `é˜…è¯»ã€Š${bookTitle}ã€‹${readingTime}åˆ†é’Ÿ`;
                    break;
                    
                case 'book':
                    const finishedBook = document.getElementById('finished-book').value.trim();    
                                        const bookPages = parseInt(document.getElementById('book-pages').value) || 0;
                    
                    if (!finishedBook) {
                        alert('è¯·è¾“å…¥ä¹¦å');
                        return;
                    }
                    
                    if (bookPages <= 0) {
                        alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é¡µæ•°');
                        return;
                    }
                    
                    points = Math.floor(bookPages / 5);
                    books = 1;
                    description = `è¯»å®Œã€Š${finishedBook}ã€‹ï¼Œ${bookPages}é¡µ`;
                    break;
                          }
            
            // ä¿å­˜å½“æ—¥æ‰“å¡è®°å½•(ç”¨äºé‡ç½®)
            todayCheckins.push({
                memberId,
                points,
                time,
                books
            });
            
            // æ›´æ–°æˆå‘˜æ•°æ®
            member.points += points;
            member.time += time;
            member.books += books;
            
            // æ›´æ–°å®¶åº­æ€»æ—¶é—´
            familyTotalTime += time;
            
            // æ›´æ–°UI
            renderFamilyMembers();
            updateFamilyProgress();
            
            // é‡ç½®è¡¨å•
            document.getElementById('member-select').value = '';
            document.querySelectorAll('input').forEach(input => {
                if (input.type !== 'button' && input.type !== 'submit') {  
                          input.value = '';
                }
            });
            
            alert(`${member.emoji} ${member.name} æ‰“å¡æˆåŠŸï¼è·å¾— ${points} ç§¯åˆ†ï¼`);
        }
        
        // é‡ç½®å½“æ—¥è®°å½•
        function resetToday() {
            if (todayCheckins.length === 0) {
                alert('ä»Šæ—¥è¿˜æ²¡æœ‰æ‰“å¡è®°å½•');
                return;
            }
            
            if (!confirm('ç¡®å®šè¦é‡ç½®ä»Šæ—¥æ‰€æœ‰æ‰“å¡è®°å½•å—ï¼Ÿ')) {
                return;
            }
            
            // å›æ»šå½“æ—¥æ‰€æœ‰æ‰“å¡è®°å½•
            todayCheckins.forEach(checkin => {
                const member = familyMembers.find(m => m.id === checkin.memberId);
                if (member) {
                    member.points -= checkin.points;
                    member.time -= checkin.time;
                    member.books -= checkin.books;      
                              familyTotalTime -= checkin.time;
                }
            });
            
            // æ¸…ç©ºå½“æ—¥è®°å½•
            todayCheckins = [];
            
            // æ›´æ–°UI
            renderFamilyMembers();
            updateFamilyProgress();
            
            alert('ä»Šæ—¥æ‰“å¡è®°å½•å·²é‡ç½®');
        }
        
        // æ›´æ–°å®¶åº­è¿›åº¦
        function updateFamilyProgress() {
            const hours = Math.floor(familyTotalTime / 60);    
                        const minutes = familyTotalTime % 60;
            
            document.getElementById('family-time').textContent = `${hours}å°æ—¶${minutes}åˆ†é’Ÿ`;
            
            const progress = Math.min(100, (familyTotalTime / (7 * 60)) * 100);
            document.getElementById('family-progress').style.width = `${progress}%`;
            
            // æ›´æ–°å®¶åº­é˜…è¯»æ ‘
            const tree = document.getElementById('family-tree');
            if (progress >= 100) {
                tree.className = 'tree tree-large';
                tree.textContent = 'ğŸŒ³';
            } else if (progress >= 50) {
                tree.className = 'tree tree-medium';
                tree.textContent = 'ğŸŒ²';
            } else {  
                  tree.className = 'tree tree-small';
                tree.textContent = 'ğŸŒ±';
            }
        }
        
        // åˆå§‹åŒ–é¡µé¢
        window.onload = initPage;
    </script>
</body>
</html>